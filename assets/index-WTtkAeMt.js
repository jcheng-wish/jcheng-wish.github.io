import{j as Ie,E as N,r as C,c as $e,w as de,a as P,b as O,o as k,d as g,e as L,f as E,F as ge,g as Ee,h as A,t as pe,n as se,i as ke,k as y,l as c,u as re,m as We,p as Ae,q as je,s as Ne,v as ze,x as he,y as qe,z as Me,A as He,B as Xe,C as Ye,K as Te,D as Ge,G as Qe,H as Ze,I as ea}from"./vendor-BV-RD4Tg.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))u(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function u(t){if(t.ep)return;t.ep=!0;const r=s(t);fetch(t.href,r)}})();const ye="/consul/v1/kv/QA/Cypress/data/",aa="QA/Cypress/data/",ve=async m=>{try{const s=await(await fetch(`${ye}${m}?keys`)).text();return JSON.parse(s,(t,r)=>typeof r=="string"?r.replace(`${aa}${m}/`,""):r)}catch(i){console.error("Failed to load catalog:",i)}},we=async m=>{try{return(await ve(m)).map(s=>({name:s}))}catch(i){return console.error("Failed to load catalog:",i),[]}},le=async(m,i)=>{try{const t=(await(await fetch(`${ye}${m}/${i}`)).json())[0].Value,r=decodeURIComponent(escape(atob(t))),o=[];return r.split(`
`).forEach(a=>{const w=a.trim();if(w&&!w.startsWith("-")&&!w.startsWith(" ")){const V=w.split(":")[0];V&&o.push(V)}}),o}catch(s){return console.error("Failed to load page locations:",s),[]}},Ke=async()=>{try{const s=(await(await fetch(`${ye}basePage`)).json())[0].Value,u=decodeURIComponent(escape(atob(s))),t=Ie.load(u);return Object.keys(t.cron_job)}catch(m){return console.error("Failed to load page locations:",m),[]}},ta=async(m,i)=>{try{const t=(await(await fetch(`${ye}${m}/${i}?dc=qa`)).json())[0].Value,r=decodeURIComponent(escape(atob(t)));return Ie.load(r)}catch(s){return console.error("Failed to load page keys:",s),[]}},la=async(m,i,s)=>{try{return await(await fetch(`${ye}${m}/${i}?dc=qa`,{method:"PUT",body:s})).json()===!0}catch(u){return console.error("Failed to load page locations:",u),[]}},sa=async(m,i)=>{try{return await(await fetch(`${ye}${m}/${i}?dc=qa`,{method:"DELETE"})).json()===!0}catch(s){return console.error("Failed to delete page:",s),!1}},oa="ONLY_TEST",na="",ia="/未规划用例",ca="jcheng@wish.com",ra="P0",ua="functional",da="",ma="",fa="[]",va="26a817ae-e30e-4c86-9b94-15843b73b3d3",pa='[{"num":1,"desc":"","result":""}]',ga="",ya="",ba=[],wa="",Ca="[]",ha="",ka="",Va="Prepare",Sa="Prepare",Aa="test_step",Ta="",$a="TEXT",Ea="test_id",Pa="",_a="",La=[],Ua=[],Ia=null,Oa="a916b3df-c6da-474d-8fb7-3a8d02832182",ja=!1,Na=[{fieldId:"46065143-9d1d-11eb-b418-0242ac120002",value:'"jcheng@wish.com"'},{fieldId:"4619cc23-9d1d-11eb-b418-0242ac120002",value:'"P0"'},{fieldId:"45f2de57-9d1d-11eb-b418-0242ac120002",value:'"Prepare"'}],Ka=[],Da=[{id:"46065143-9d1d-11eb-b418-0242ac120002",name:"责任人",customData:null,type:"member",value:"jcheng@wish.com"},{id:"4619cc23-9d1d-11eb-b418-0242ac120002",name:"用例等级",customData:null,type:"select",value:"P0"},{id:"45f2de57-9d1d-11eb-b418-0242ac120002",name:"用例状态",customData:null,type:"select",value:"Prepare"}],Fa={name:oa,num:na,nodePath:ia,maintainer:ca,priority:ra,type:ua,method:da,prerequisite:ma,testId:fa,nodeId:va,steps:pa,stepDesc:ga,stepResult:ya,selected:ba,remark:wa,tags:Ca,demandId:ha,demandName:ka,status:Va,reviewStatus:Sa,stepDescription:Aa,expectedResult:Ta,stepModel:$a,customNum:Ea,followPeople:Pa,versionId:_a,fields:La,follows:Ua,id:Ia,projectId:Oa,casePublic:ja,addFields:Na,editFields:Ka,requestFields:Da},xa="name",Ja="- Case: test",Ba="f817a2b7-cb41-40c5-a91f-7e54ab1c4636",Ra="a916b3df-c6da-474d-8fb7-3a8d02832182",Wa=[],za=[],qa={name:xa,stepDescription:Ja,id:Ba,projectId:Ra,fields:Wa,requestFields:za},Ma="测试用",Ha=[],Xa=["jcheng@wish.com"],Ya="regression",Ga="",Qa=null,Za=null,et=!1,at=!1,tt=[],lt="fe62d0dc-10c4-4d34-9f86-4abcd780e004",st="/未规划模块",ot="[]",nt=null,it="2b2df542-45e9-4267-8288-be4dc3609a57",ct={name:Ma,projectIds:Ha,principals:Xa,stage:Ya,description:Ga,plannedStartTime:Qa,plannedEndTime:Za,automaticStatusUpdate:et,repeatCase:at,follows:tt,nodeId:lt,nodePath:st,tags:ot,status:nt,workspaceId:it},rt="name",ut=["byzhang@wish.com"],dt="regression",mt=!1,ft=!1,vt="fe62d0dc-10c4-4d34-9f86-4abcd780e004",pt="/未规划模块",gt='["Wishpost"]',yt="Prepare",bt="4889f699-1a96-4760-92e7-bde66b898233",wt="2b2df542-45e9-4267-8288-be4dc3609a57",Ct=1750747184944,ht=1750747196812,kt="byzhang@wish.com",Vt="a916b3df-c6da-474d-8fb7-3a8d02832182",St="Automation",At=!1,Tt="NOTSET",$t="Byron",Et=[],Pt="Jay",_t=!0,Lt=!1,Ut={name:rt,principals:ut,stage:dt,automaticStatusUpdate:mt,repeatCase:ft,nodeId:vt,nodePath:pt,tags:gt,status:yt,id:bt,workspaceId:wt,createTime:Ct,updateTime:ht,creator:kt,projectId:Vt,projectName:St,scheduleOpen:At,scheduleStatus:Tt,createUser:$t,followUsers:Et,principalName:Pt,isMetricLoadOver:_t,showFollow:Lt},It=["1d68a06e-502a-4ef7-bf83-df2034a664ef"],Ot={custom:!1,projectId:"a916b3df-c6da-474d-8fb7-3a8d02832182",versionId:null,nodeIds:[],planId:"75aaaac2-3384-4895-89e3-08ac513f42e2",selectAll:!1,unSelectIds:[],name:"测试"},jt=!0,Nt="75aaaac2-3384-4895-89e3-08ac513f42e2",Kt={ids:It,request:Ot,checked:jt,planId:Nt},Y="/metersphere",Oe="a916b3df-c6da-474d-8fb7-3a8d02832182",Q=async()=>{try{const i=await(await fetch(`${Y}/api/signin`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"byzhang@wish.com",password:"Shanghai2023"})})).json();if(i.success)return{csrfToken:i.data.csrfToken,sessionId:i.data.sessionId};throw new Error("Login failed")}catch(m){throw console.error("Failed to sign in:",m),m}},De=async()=>{try{const{csrfToken:m,sessionId:i}=await Q();return(await(await fetch(`${Y}/track/test/case/list`,{method:"POST",headers:{"CSRF-TOKEN":m,"X-AUTH-TOKEN":i,"Content-Type":"application/json"},body:JSON.stringify({projectId:Oe})})).json()).data}catch(m){throw console.error("Failed to load metersphere:",m),m}},Dt=async()=>{try{const{csrfToken:m,sessionId:i}=await Q();return(await(await fetch(`${Y}/track/plan/node/list/a916b3df-c6da-474d-8fb7-3a8d02832182`,{method:"POST",headers:{"CSRF-TOKEN":m,"X-AUTH-TOKEN":i,"Content-Type":"application/json"}})).json()).data[0].caseNum}catch(m){throw console.error("Failed to load metersphere:",m),m}},Ft=async(m,i)=>{try{const{csrfToken:s,sessionId:u}=await Q();return(await(await fetch(`${Y}/track/test/plan/list/${m}/${i}`,{method:"POST",headers:{"CSRF-TOKEN":s,"X-AUTH-TOKEN":u,"Content-Type":"application/json"},body:JSON.stringify({projectId:Oe})})).json()).data.listObject}catch(s){throw console.error("Failed to load metersphere:",s),s}},Le=async()=>{try{return(await De()).map(s=>s.name)}catch(m){return console.error("Failed to get case list:",m),[]}},Ce=async()=>{try{return(await De()).map(s=>({id:s.id,name:s.name,content:s.stepDescription}))}catch(m){return console.error("Failed to get case list:",m),[]}},xt=async(m,i)=>{try{return(await Ft(m,i)).map(t=>({id:t.id,name:t.name,tags:t.tags,assignee:t.principalUsers[0].name}))}catch(s){return console.error("Failed to get case list:",s),[]}},Jt=async(m,i,s,u,t)=>{if(!(m===""||i===""||s===""))try{const{csrfToken:r,sessionId:o}=await Q();switch(s){case"Jay":s="jcheng@wish.com";break;case"Byron":s="byzhang@wish.com";break;case"Alex":s="alexyu@wish.com";break;default:s="jcheng@wish.com";break}const a={...Fa};a.name=m,a.maintainer=s,a.priority=i,a.stepDescription=u,a.customNum=m,a.addFields=a.addFields.map(h=>h.fieldId==="46065143-9d1d-11eb-b418-0242ac120002"?{...h,value:`"${s}"`}:h.fieldId==="4619cc23-9d1d-11eb-b418-0242ac120002"?{...h,value:`"${i}"`}:h),a.requestFields=a.requestFields.map(h=>h.name==="责任人"?{...h,value:s}:h.name==="用例等级"?{...h,value:i}:h);const w=new FormData;w.append("request",new Blob([JSON.stringify(a)],{type:"application/json"}));let $=await(await fetch(`${Y}/track/test/case/add`,{method:"POST",headers:{"CSRF-TOKEN":r,"X-AUTH-TOKEN":o},body:w})).json();if($.success===!0)N({title:"Success",message:"Case submitted successfully",type:"success"}),t&&t();else{let h=$.message;N({title:"Error",message:h,type:"error"})}}catch(r){throw console.error("Failed to submit case:",r),r}},Bt=async(m,i,s,u)=>{if(!(m===""||i===""||s===""))try{const{csrfToken:t,sessionId:r}=await Q();switch(i){case"Jay":i="jcheng@wish.com";break;case"Byron":i="byzhang@wish.com";break;case"Alex":i="alexyu@wish.com";break;default:i="jcheng@wish.com";break}const o={...ct};o.name=m,o.principals=[i],o.tags=`["${s}"]`,console.log(o);let w=await(await fetch(`${Y}/track/test/plan/add`,{method:"POST",headers:{"CSRF-TOKEN":t,"X-AUTH-TOKEN":r,"Content-Type":"application/json"},body:JSON.stringify(o)})).json();if(w.success===!0)N({title:"Success",message:"Suite submitted successfully",type:"success"}),u&&u();else{let V=w.message;N({title:"Error",message:V,type:"error"})}}catch(t){throw console.error("Failed to submit suite:",t),t}},Rt=async(m,i,s,u,t)=>{if(!(i===""||s===""||u===""))try{const{csrfToken:r,sessionId:o}=await Q();switch(s){case"Jay":s="jcheng@wish.com";break;case"Byron":s="byzhang@wish.com";break;case"Alex":s="alexyu@wish.com";break;default:s="jcheng@wish.com";break}const a={...Ut};a.id=m,a.name=i,a.principals=[s],a.tags=`["${u}"]`;const w=new Date().getTime();a.createTime=w,a.updateTime=w,console.log(a);let $=await(await fetch(`${Y}/track/test/plan/edit`,{method:"POST",headers:{"CSRF-TOKEN":r,"X-AUTH-TOKEN":o,"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if($.success===!0)N({title:"Success",message:"Suite edited successfully",type:"success"}),t&&t();else{let h=$.message;N({title:"Error",message:h,type:"error"})}}catch(r){throw console.error("Failed to edit suite:",r),r}},Wt=async(m,i,s,u)=>{try{const{csrfToken:t,sessionId:r}=await Q(),o={...qa};o.id=m,o.name=i,o.stepDescription=s;const a=new FormData;a.append("request",new Blob([JSON.stringify(o)],{type:"application/json"}));let V=await(await fetch(`${Y}/track/test/case/edit`,{method:"POST",headers:{"CSRF-TOKEN":t,"X-AUTH-TOKEN":r},body:a})).json();if(V.success===!0)N({title:"Success",message:"Case edited successfully",type:"success"}),u&&u();else{let $=V.message;N({title:"Error",message:$,type:"error"})}}catch(t){throw console.error("Failed to edit case:",t),t}},zt=async(m,i)=>{try{const{csrfToken:s,sessionId:u}=await Q();let r=await(await fetch(`${Y}/track/test/case/deleteToGc/${m}`,{method:"POST",headers:{"CSRF-TOKEN":s,"X-AUTH-TOKEN":u}})).json();if(r.success===!0)N({title:"Success",message:"Case deleted successfully",type:"success"}),i&&i();else{let o=r.message;N({title:"Error",message:o,type:"error"})}}catch(s){throw console.error("Failed to edit case:",s),s}},qt=async(m,i)=>{try{const{csrfToken:s,sessionId:u}=await Q();let r=await(await fetch(`${Y}/track/test/plan/delete/${m}`,{method:"POST",headers:{"CSRF-TOKEN":s,"X-AUTH-TOKEN":u}})).json();if(r.success===!0)N({title:"Success",message:"Suite deleted successfully",type:"success"}),i&&i();else{let o=r.message;N({title:"Error",message:o,type:"error"})}}catch(s){throw console.error("Failed to delete case:",s),s}},_e=async m=>{try{const{csrfToken:i,sessionId:s}=await Q();let t=await(await fetch(`${Y}/track/test/plan/case/list/1/100`,{method:"POST",headers:{"CSRF-TOKEN":i,"X-AUTH-TOKEN":s,"Content-Type":"application/json"},body:JSON.stringify({planId:m,projectId:Oe})})).json();return t=t.data.listObject,t=t.map(r=>({id:r.id,name:r.name})),t}catch(i){throw console.error("Failed to delete case:",i),i}},Mt=async(m,i,s,u)=>{try{const{csrfToken:t,sessionId:r}=await Q(),o={...Kt};o.ids=[`${m}`],o.planId=s,o.request.planId=s,o.request.name=i;let w=await(await fetch(`${Y}/track/test/plan/relevance`,{method:"POST",headers:{"CSRF-TOKEN":t,"X-AUTH-TOKEN":r,"Content-Type":"application/json"},body:JSON.stringify(o)})).json();if(w.success===!0)N({title:"Success",message:"Case added successfully",type:"success"}),u&&u();else{let V=w.message;N({title:"Error",message:V,type:"error"})}}catch(t){throw console.error("Failed to add case:",t),t}},Ht=async(m,i)=>{try{const{csrfToken:s,sessionId:u}=await Q();let r=await(await fetch(`${Y}/track/test/plan/case/delete/${m}`,{method:"POST",headers:{"CSRF-TOKEN":s,"X-AUTH-TOKEN":u,"Content-Type":"application/json"}})).json();if(r.success===!0)N({title:"Success",message:"Case removed successfully",type:"success"}),i&&i();else{let o=r.message;N({title:"Error",message:o,type:"error"})}}catch(s){throw console.error("Failed to remove case:",s),s}},Xt=async(m,i,s,u)=>{try{const{csrfToken:t,sessionId:r}=await Q();let a=await(await fetch(`${Y}/track/test/plan/case/edit/order`,{method:"POST",headers:{"CSRF-TOKEN":t,"X-AUTH-TOKEN":r,"Content-Type":"application/json"},body:JSON.stringify({moveId:i,moveMode:u,targetId:s,groupId:m})})).json();if(a.success===!0)console.log("case ordered");else{let w=a.message;N({title:"Error",message:w,type:"error"})}}catch(t){throw console.error("Failed to order case:",t),t}},Fe=m=>{let i="",s="";return m.map(t=>{let r=[];if(t.action==="Page")return r.push(`- Page: ${t.platform}.${t.selectedPage}`),i=t.platform,s=t.selectedPage,r.join(`
`);if(t.platform&&t.selectedPage&&(t.platform!==i||t.selectedPage!==s)&&(r.push(`- Page: ${t.platform}.${t.selectedPage}`),i=t.platform,s=t.selectedPage),t.action==="Case")return r.push(`- Case: ${t.selectedCase}`),r.join(`
`);let o="";switch(t.action){case"Click":o="findElementThenClick";break;case"Assert":o="findElementThenExist";break;case"Type":o="findElementThenType";break;case"Wait":o="wait";break;case"ClickUntilExist":o="clickUntilExist";break;case"Open":o="open";break;case"Clear":o="findElementThenClear";break;case"SaveElementText":o="getElementProperty";break;case"UploadImage":o="findElementThenSelectFile";break;case"TriggerCronJob":o="triggerCronJob";break;case"SaveTimestampAsEnv":o="getTimestampNumber";break;case"CustomAction":o=t.customAction;break;default:o=""}let a={};t.action==="Wait"?a.seconds=t.waitSeconds:t.action==="TriggerCronJob"?a.job=t.selectedJob:t.action==="ClickUntilExist"?(a.click=`$page.${t.selectedLocation}`,a.check=`$page.${t.checkLocation}`):t.action==="SaveTimestampAsEnv"?a.save=t.saveElementKey:t.action==="CustomAction"?a.args=t.customActionArgs.map(V=>`${V.key}: ${V.value}`).join(`
`):(a.find=`$page.${t.selectedLocation}`,t.action==="Type"&&(t.valueIsEnv?a.value="$env."+t.value:a.value=t.value));let w="";switch(t.action){case"Open":w=`- Desc: ${t.desc}
  Act: ${o}`;break;case"Wait":w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
    seconds: ${a.seconds}`;break;case"TriggerCronJob":w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
    job: ${a.job}`;break;case"ClickUntilExist":w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
    click: ${a.click}
    check: ${a.check}`;break;case"SaveElementText":w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
    prop: text
    save: ${t.saveElementKey}`;break;case"UploadImage":w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
    find: ${a.find}
    file: ./cypress/fixtures/wishpost/id2.png`;break;case"TriggerCronJob":w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
    job: ${a.job}`;break;case"SaveTimestampAsEnv":w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
    save: ${a.save}`;break;case"CustomAction":const V=t.customActionArgs.reduce((h,{key:S,value:D})=>(S&&D&&(h[S]=D),h),{}),$=Object.entries(V).map(([h,S])=>`    ${h}: ${S}`).join(`
`);$==""?w=`- Desc: ${t.desc}
  Act: ${o}`:w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
${$}`;break;default:w=`- Desc: ${t.desc}
  Act: ${o}
  Args:
    find: ${a.find}${a.value?`
    value: ${a.value}`:""}`}return r.push(w),r.join(`
`)}).join(`

`)},Yt=m=>{let i="";return m.forEach(s=>{i+=`${s.key}:
`,s.values.forEach(u=>{i+=`  - ${u}
`})}),i},Gt=m=>{try{const i=Ie.load(m),s=[];let u,t;i.forEach(async o=>{const a={action:"",platform:"",selectedPage:"",desc:"",value:"",selectedCase:"",selectedLocation:"",checkLocation:"",saveElementKey:"",selectedJob:"",locationKeys:[],customAction:"",needArgs:!1,valueIsEnv:!1,customActionArgs:[],waitSeconds:"",descValid:!0,valueValid:!0,secondsValid:!0,saveValid:!0,customActionValid:!0,caseValid:!0,actionValid:!0};if(o.Page){const[w,V]=o.Page.split(".");a.action="Page",a.platform=w,a.selectedPage=V,u=w,t=V}if(o.Case&&(a.action="Case",a.selectedCase=o.Case.trim()),o.Click)a.action="Click",a.selectedLocation=o.Click.replace("$page.",""),a.platform=u,a.selectedPage=t,a.locationKeys=await le(a.platform,a.selectedPage);else if(o.Desc)switch(a.desc=o.Desc,a.action=o.Act,o.Act){case"open":a.action="Open";break;case"findElementThenClick":a.action="Click",a.selectedLocation=o.Args.find.replace("$page.",""),a.platform=u,a.selectedPage=t,a.locationKeys=await le(a.platform,a.selectedPage);break;case"findElementThenType":a.action="Type",a.selectedLocation=o.Args.find.replace("$page.",""),o.Args.value&&typeof o.Args.value=="string"?(a.value=o.Args.value.replace("$page.",""),o.Args.value.startsWith("$env.")&&(a.value=o.Args.value.replace("$env.",""),a.valueIsEnv=!0)):a.value=String(o.Args.value),a.platform=u,a.selectedPage=t,a.locationKeys=await le(a.platform,a.selectedPage);break;case"findElementThenExist":a.action="Assert",a.selectedLocation=o.Args.find.replace("$page.",""),a.platform=u,a.selectedPage=t,a.locationKeys=await le(a.platform,a.selectedPage);break;case"wait":a.action="Wait",a.waitSeconds=o.Args.seconds;break;case"clickUntilExist":a.action="ClickUntilExist",a.checkLocation=o.Args.check.replace("$page.",""),a.selectedLocation=o.Args.click.replace("$page.",""),a.platform=u,a.selectedPage=t,a.locationKeys=await le(a.platform,a.selectedPage);break;case"findElementThenClear":a.action="Clear",a.selectedLocation=o.Args.find.replace("$page.",""),a.platform=u,a.selectedPage=t,a.locationKeys=await le(a.platform,a.selectedPage);break;case"getElementProperty":a.action="SaveElementText",a.saveElementKey=o.Args.save,a.platform=u,a.selectedPage=t,a.locationKeys=await le(a.platform,a.selectedPage);break;case"findElementThenSelectFile":a.action="UploadImage",a.selectedLocation=o.Args.find.replace("$page.",""),a.platform=u,a.selectedPage=t,a.locationKeys=await le(a.platform,a.selectedPage);break;case"triggerCronJob":a.action="TriggerCronJob",a.selectedJob=o.Args.job.replace("$data.basePage.cron_job.","");break;case"getTimestampNumber":a.action="SaveTimestampAsEnv",a.saveElementKey=o.Args.save;break;default:a.action="CustomAction",a.customAction=o.Act,o.Args?(a.needArgs=!0,a.customActionArgs=Object.entries(o.Args).map(([w,V])=>({key:w,value:V}))):a.needArgs=!1}s.push(a)});const r=["Page","Click","Assert","Type","ClickUntilExist","Clear","SaveElementText","UploadImage"];return s}catch(i){console.error("Error parsing case:",i)}},be=(m,i)=>{const s=m.__vccOpts||m;for(const[u,t]of i)s[u]=t;return s},Qt={__name:"RequiredSelect",props:{options:{type:Array,required:!0,default:()=>[]},modelValue:{type:[String,Number],required:!0},noOptionsText:{type:String,default:"No options available"},filterable:{type:Boolean,default:!1}},emits:["update:modelValue","blur"],setup(m,{emit:i}){const s=m,u=i,t=C(s.modelValue),r=$e(()=>t.value!==void 0&&t.value!=="");de(()=>s.modelValue,a=>{t.value=a});const o=a=>{u("update:modelValue",a)};return(a,w)=>{const V=P("el-option"),$=P("el-select");return k(),O($,{modelValue:t.value,"onUpdate:modelValue":w[0]||(w[0]=h=>t.value=h),class:se({"required-select":!0,"is-invalid":!r.value}),filterable:m.filterable,onChange:o,onBlur:w[1]||(w[1]=h=>a.$emit("blur"))},{default:g(()=>[(k(!0),L(ge,null,Ee(m.options,h=>(k(),O(V,{key:h.value,label:h.label,value:h.value,disabled:h.disabled},null,8,["label","value","disabled"]))),128)),m.options.length?E("",!0):(k(),O(V,{key:0,value:"",disabled:""},{default:g(()=>[A(pe(m.noOptionsText),1)]),_:1}))]),_:1},8,["modelValue","class","filterable"])}}},z=be(Qt,[["__scopeId","data-v-be645609"]]),Zt={class:"step-container"},el={class:"step-header"},al={key:0,class:"desc"},tl={key:1,class:"custom-action"},ll={key:0,class:"args-table"},sl={class:"args-header"},ol={key:4,class:"page"},nl={class:"page-row"},il={key:0,class:"page-row"},cl={key:1,class:"page-row"},rl={key:2,class:"page-row"},ul={key:5,class:"check"},dl={key:6,class:"wait"},ml={key:7,class:"save"},fl={key:8,class:"job"},vl={key:9,class:"value"},pl={__name:"CaseForm",props:{steps:{type:Array,required:!0}},emits:["update:steps"],setup(m,{emit:i}){const s=m,u=i,t=["Click","Assert","Type","Wait","Open","Clear","SaveElementText","UploadImage","TriggerCronJob","SaveTimestampAsEnv","CustomAction"],r=["Page","Click","Assert","Type","ClickUntilExist","Clear","SaveElementText","UploadImage"],o=["ClickUntilExist"],a=["Type"],w=["Wait"],V=["SaveElementText","SaveTimestampAsEnv"],$=["CustomAction"],h=C([]),S=C([]),D=C([]),q=C([]),U=l=>t.includes(l),R=l=>a.includes(l),M=l=>r.includes(l),x=l=>o.includes(l),G=l=>w.includes(l),ee=l=>V.includes(l),ae=l=>$.includes(l);de(()=>s.steps,l=>{l.forEach(e=>{e.desc&&(e.descValid=!0),e.value&&(e.valueValid=!0),e.waitSeconds&&(e.secondsValid=!0),e.saveElementKey&&(e.saveValid=!0),e.customAction&&(e.customActionValid=!0),e.action&&(e.actionValid=!0),e.selectedCase&&(e.caseValid=!0)})},{deep:!0,immediate:!0});const oe=(l,e)=>l.action.trim()?U(l.action)&&!l.desc.trim()?(s.steps[e].descValid=!1,!1):R(l.action)&&!l.value.trim()?(s.steps[e].valueValid=!1,!1):G(l.action)&&!l.waitSeconds.trim()?(s.steps[e].secondsValid=!1,!1):ee(l.action)&&!l.saveElementKey.trim()?(s.steps[e].saveValid=!1,!1):ae(l.action)&&!l.customAction.trim()?(s.steps[e].customActionValid=!1,!1):!(l.action==="Case"&&!l.selectedCase.trim()||M(l.action)&&(!l.platform.trim()||!l.selectedPage.trim())||M(l.action)&&l.action!="Page"&&l.selectedLocation===""||x(l.action)&&l.checkLocation===""||l.action==="TriggerCronJob"&&l.selectedJob===""):(s.steps[e].actionValid=!1,!1),ue=l=>{if(!oe(s.steps[l],l))return;const e=[...s.steps];e.splice(l+1,0,{action:"",platform:"",selectedPage:"",desc:"",value:"",waitSeconds:"",selectedCase:"",selectedLocation:"",checkLocation:"",saveElementKey:"",selectedJob:"",locationKeys:[],customAction:"",needArgs:!1,valueIsEnv:!1,customActionArgs:[],descValid:!0,valueValid:!0,secondsValid:!0,saveValid:!0,customActionValid:!0,caseValid:!0,actionValid:!0}),u("update:steps",e)},ne=l=>{if(s.steps.length>1){const e=[...s.steps];e.splice(l,1),u("update:steps",e)}},H=((l,e)=>{let T=null;return function(...j){T&&clearTimeout(T),T=setTimeout(()=>{l.apply(this,j)},e)}})(async l=>{l.platform&&l.selectedPage&&(l.locationKeys=await le(l.platform,l.selectedPage))},300);de(()=>s.steps,l=>{l.forEach(e=>{de([()=>e.platform,()=>e.selectedPage],async([T,j],[te,ce])=>{(T!==te||j!==ce)&&(await Ne(),H(e))}),de(()=>e.platform,(T,j)=>{T!==j&&(e.selectedPage="",e.selectedLocation="",e.checkLocation="",e.locationKeys=[])})})},{deep:!0});const f=async()=>{h.value=await ve("wishpost"),S.value=await ve("wishwms"),q.value=await Ke(),D.value=await Le()},p=async()=>{D.value=await Le()},I=l=>{l.customActionArgs||(l.customActionArgs=[]),l.customActionArgs.push({key:"",value:""})},F=(l,e)=>{l.customActionArgs.splice(e,1)},K=async l=>{l.locationKeys=await le(l.platform,l.selectedPage)},W=async l=>{l.platform==="wishpost"?h.value=await ve("wishpost"):l.platform==="wishwms"&&(S.value=await ve("wishwms"))},Z=(l,e)=>{U(l.action)&&!l.desc.trim()?s.steps[e].descValid=!1:s.steps[e].descValid=!0},J=(l,e)=>{R(l.action)&&!l.value.trim()?s.steps[e].valueValid=!1:s.steps[e].valueValid=!0},b=(l,e)=>{G(l.action)&&!l.waitSeconds.trim()?s.steps[e].secondsValid=!1:s.steps[e].secondsValid=!0},d=(l,e)=>{ee(l.action)&&!l.saveElementKey.trim()?s.steps[e].saveValid=!1:s.steps[e].saveValid=!0},_=(l,e)=>{ae(l.action)&&!l.customAction.trim()?s.steps[e].customActionValid=!1:s.steps[e].customActionValid=!0},B=[{label:"Please select an action",value:"",disabled:!0},{label:"Case",value:"Case"},{label:"Page",value:"Page"},{label:"Click",value:"Click"},{label:"Assert",value:"Assert"},{label:"Type",value:"Type"},{label:"Wait",value:"Wait"},{label:"ClickUntilExist",value:"ClickUntilExist"},{label:"Open",value:"Open"},{label:"Clear",value:"Clear"},{label:"SaveElementText",value:"SaveElementText"},{label:"UploadImage",value:"UploadImage"},{label:"TriggerCronJob",value:"TriggerCronJob"},{label:"SaveTimestampAsEnv",value:"SaveTimestampAsEnv"},{label:"CustomAction",value:"CustomAction"}];return ke(async()=>{await f()}),(l,e)=>{const T=P("el-input"),j=P("el-checkbox"),te=P("el-button"),ce=P("el-table-column"),Pe=P("el-table"),fe=P("el-icon");return k(),L("div",null,[(k(!0),L(ge,null,Ee(m.steps,(n,X)=>(k(),L("div",{key:X},[y("div",Zt,[y("div",el,[y("span",null,"Step "+pe(X+1),1),m.steps.length>1?(k(),O(re(We),{key:0,class:"delete-icon",onClick:v=>ne(X)},null,8,["onClick"])):E("",!0)]),U(n.action)?(k(),L("div",al,[e[0]||(e[0]=y("span",null,"Desc:",-1)),c(T,{modelValue:n.desc,"onUpdate:modelValue":v=>n.desc=v,class:se(["desc-input",{"is-invalid":!n.descValid}]),onBlur:v=>Z(n,X)},null,8,["modelValue","onUpdate:modelValue","class","onBlur"])])):E("",!0),e[17]||(e[17]=y("span",null,"Action: ",-1)),c(z,{modelValue:n.action,"onUpdate:modelValue":v=>n.action=v,options:B,class:"action-select"},null,8,["modelValue","onUpdate:modelValue"]),ae(n.action)?(k(),L("div",tl,[e[5]||(e[5]=y("span",null,"Custom Action: ",-1)),c(T,{modelValue:n.customAction,"onUpdate:modelValue":v=>n.customAction=v,class:se(["custom-action-input",{"is-invalid":!n.customActionValid}]),onBlur:v=>_(n,X)},null,8,["modelValue","onUpdate:modelValue","class","onBlur"]),c(j,{modelValue:n.needArgs,"onUpdate:modelValue":v=>n.needArgs=v,class:"args-checkbox"},{default:g(()=>e[1]||(e[1]=[A(" Need Args? ")])),_:2},1032,["modelValue","onUpdate:modelValue"]),e[6]||(e[6]=y("br",null,null,-1)),n.needArgs?(k(),L("div",ll,[y("div",sl,[e[3]||(e[3]=y("span",null,"Args: ",-1)),c(te,{type:"primary",size:"small",onClick:v=>I(n)},{default:g(()=>e[2]||(e[2]=[A("添加参数")])),_:2},1032,["onClick"])]),c(Pe,{data:n.customActionArgs,style:{width:"100%"}},{default:g(()=>[c(ce,{label:"Key"},{default:g(v=>[c(T,{modelValue:v.row.key,"onUpdate:modelValue":Se=>v.row.key=Se,placeholder:"请输入key"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),c(ce,{label:"Value"},{default:g(v=>[c(T,{modelValue:v.row.value,"onUpdate:modelValue":Se=>v.row.value=Se,placeholder:"请输入value"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),c(ce,{label:"Operation"},{default:g(v=>[c(te,{type:"danger",size:"small",onClick:Se=>F(n,v.$index)},{default:g(()=>e[4]||(e[4]=[A("Delete")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"])])):E("",!0)])):E("",!0),n.action==="Case"?(k(),O(z,{key:2,modelValue:n.selectedCase,"onUpdate:modelValue":v=>n.selectedCase=v,options:D.value.map(v=>({label:v,value:v})),class:"case-select",filterable:""},null,8,["modelValue","onUpdate:modelValue","options"])):E("",!0),n.action==="Case"?(k(),O(fe,{key:3,onClick:p,class:"refresh-icon"},{default:g(()=>[c(re(Ae))]),_:1})):E("",!0),M(n.action)?(k(),L("div",ol,[y("div",nl,[e[7]||(e[7]=y("span",{class:"action-label"},"Page: ",-1)),c(z,{modelValue:n.platform,"onUpdate:modelValue":v=>n.platform=v,options:[{label:"Please select a platform",value:"",disabled:!0},{label:"wishpost",value:"wishpost"},{label:"wishwms",value:"wishwms"}],class:"platform-select"},null,8,["modelValue","onUpdate:modelValue"])]),n.platform==="wishpost"?(k(),L("div",il,[e[8]||(e[8]=y("span",{class:"action-label"},"WishPost Page: ",-1)),c(z,{modelValue:n.selectedPage,"onUpdate:modelValue":v=>n.selectedPage=v,options:h.value.map(v=>({label:v,value:v})),filterable:"",class:"page-select"},null,8,["modelValue","onUpdate:modelValue","options"]),c(fe,{onClick:v=>W(n),class:"refresh-icon"},{default:g(()=>[c(re(Ae))]),_:2},1032,["onClick"])])):E("",!0),n.platform==="wishwms"?(k(),L("div",cl,[e[9]||(e[9]=y("span",{class:"action-label"},"WishWMS Page: ",-1)),c(z,{modelValue:n.selectedPage,"onUpdate:modelValue":v=>n.selectedPage=v,options:S.value.map(v=>({label:v,value:v})),filterable:"",class:"page-select"},null,8,["modelValue","onUpdate:modelValue","options"]),c(fe,{onClick:v=>W(n),class:"refresh-icon"},{default:g(()=>[c(re(Ae))]),_:2},1032,["onClick"])])):E("",!0),n.platform!=""&&n.selectedPage!=""&&n.action!="Page"?(k(),L("div",rl,[e[10]||(e[10]=y("span",{class:"action-label"},"Location: ",-1)),c(z,{modelValue:n.selectedLocation,"onUpdate:modelValue":v=>n.selectedLocation=v,options:n.locationKeys.map(v=>({label:v,value:v})),filterable:"",class:"location-select"},null,8,["modelValue","onUpdate:modelValue","options"]),c(fe,{onClick:v=>K(n),class:"refresh-icon"},{default:g(()=>[c(re(Ae))]),_:2},1032,["onClick"])])):E("",!0)])):E("",!0),x(n.action)?(k(),L("div",ul,[e[11]||(e[11]=y("span",null,"Check: ",-1)),c(z,{modelValue:n.platform,"onUpdate:modelValue":v=>n.platform=v,options:[{label:"Please select a platform",value:"",disabled:!0},{label:"wishpost",value:"wishpost"},{label:"wishwms",value:"wishwms"}]},null,8,["modelValue","onUpdate:modelValue"]),n.platform==="wishpost"?(k(),O(z,{key:0,options:h.value.map(v=>({label:v,value:v})),modelValue:n.selectedPage,"onUpdate:modelValue":v=>n.selectedPage=v},null,8,["options","modelValue","onUpdate:modelValue"])):E("",!0),n.platform==="wishwms"?(k(),O(z,{key:1,options:S.value.map(v=>({label:v,value:v})),modelValue:n.selectedPage,"onUpdate:modelValue":v=>n.selectedPage=v},null,8,["options","modelValue","onUpdate:modelValue"])):E("",!0),n.platform!=""&&n.selectedPage!=""?(k(),O(z,{key:2,modelValue:n.checkLocation,"onUpdate:modelValue":v=>n.checkLocation=v,filterable:"",options:n.locationKeys.map(v=>({label:v,value:v}))},null,8,["modelValue","onUpdate:modelValue","options"])):E("",!0)])):E("",!0),G(n.action)?(k(),L("div",dl,[e[12]||(e[12]=y("span",null,"Seconds: ",-1)),c(T,{modelValue:n.waitSeconds,"onUpdate:modelValue":v=>n.waitSeconds=v,placeholder:"10",class:se(["seconds-input",{"is-invalid":!n.secondsValid}]),onBlur:v=>b(n,X)},null,8,["modelValue","onUpdate:modelValue","class","onBlur"])])):E("",!0),ee(n.action)?(k(),L("div",ml,[e[13]||(e[13]=y("span",null,"Save: ",-1)),c(T,{modelValue:n.saveElementKey,"onUpdate:modelValue":v=>n.saveElementKey=v,class:se(["save-input",{"is-invalid":!n.saveValid}]),onBlur:v=>d(n,X)},null,8,["modelValue","onUpdate:modelValue","class","onBlur"])])):E("",!0),n.action==="TriggerCronJob"?(k(),L("div",fl,[e[14]||(e[14]=y("span",null,"Job: ",-1)),c(z,{modelValue:n.selectedJob,"onUpdate:modelValue":v=>n.selectedJob=v,options:q.value.map(v=>({value:v,label:v})),filterable:""},null,8,["modelValue","onUpdate:modelValue","options"])])):E("",!0),R(n.action)?(k(),L("div",vl,[e[16]||(e[16]=y("span",null,"Value: ",-1)),c(j,{modelValue:n.valueIsEnv,"onUpdate:modelValue":v=>n.valueIsEnv=v,class:"args-checkbox"},{default:g(()=>e[15]||(e[15]=[A(" Env Variable?")])),_:2},1032,["modelValue","onUpdate:modelValue"]),c(T,{modelValue:n.value,"onUpdate:modelValue":v=>n.value=v,class:se(["value-input",{"is-invalid":!n.valueValid}]),onBlur:v=>J(n,X)},null,8,["modelValue","onUpdate:modelValue","class","onBlur"])])):E("",!0)]),c(fe,{onClick:v=>ue(X),class:"add-step-icon"},{default:g(()=>[c(re(je))]),_:2},1032,["onClick"])]))),128))])}}},xe=be(pl,[["__scopeId","data-v-ce3f5738"]]),gl={key:0,class:"preview-modal"},yl={class:"preview-content"},bl={class:"preview-header"},wl={key:1,class:"submit-modal"},Cl={class:"submit-content"},hl={class:"submit-header"},kl={class:"submit-body"},Vl={__name:"CaseCreation",setup(m){const i=["Click","Assert","Type","Wait","Open","Clear","SaveElementText","UploadImage","TriggerCronJob","SaveTimestampAsEnv","CustomAction"],s=["Page","Click","Assert","Type","ClickUntilExist","Clear","SaveElementText","UploadImage"],u=["ClickUntilExist"],t=["Type"],r=["Wait"],o=["SaveElementText","SaveTimestampAsEnv"],a=["CustomAction"],w=C([]),V=C([]),$=C([]),h=C([]),S=C([{action:"",platform:"",selectedPage:"",desc:"",value:"",selectedCase:"",selectedLocation:"",checkLocation:"",saveElementKey:"",selectedJob:"",locationKeys:[],customAction:"",needArgs:!1,customActionArgs:[],descValid:!0,valueValid:!0,secondsValid:!0,saveValid:!0,customActionValid:!0,caseValid:!0,actionValid:!0,waitSeconds:""}]),D=C(!1),q=C(!1),U=C(""),R=C(""),M=C(""),x=C(!0),G=C(""),ee=b=>i.includes(b),ae=b=>t.includes(b),oe=b=>s.includes(b),ue=b=>u.includes(b),ne=b=>r.includes(b),ie=b=>o.includes(b),me=b=>a.includes(b),H=(b,d)=>b.action.trim()?ee(b.action)&&!b.desc.trim()?(S.value[d].descValid=!1,!1):ae(b.action)&&!b.value.trim()?(S.value[d].valueValid=!1,!1):ne(b.action)&&!b.waitSeconds.trim()?(S.value[d].secondsValid=!1,!1):ie(b.action)&&!b.saveElementKey.trim()?(S.value[d].saveValid=!1,!1):me(b.action)&&!b.customAction.trim()?(S.value[d].customActionValid=!1,!1):!(b.action==="Case"&&!b.selectedCase.trim()||oe(b.action)&&(!b.platform.trim()||!b.selectedPage.trim())||oe(b.action)&&b.action!="Page"&&b.selectedLocation===""||ue(b.action)&&b.checkLocation===""||b.action==="TriggerCronJob"&&b.selectedJob===""):(S.value[d].actionValid=!1,!1),I=((b,d)=>{let _=null;return function(...B){_&&clearTimeout(_),_=setTimeout(()=>{b.apply(this,B)},d)}})(async b=>{b.platform&&b.selectedPage&&(b.locationKeys=await le(b.platform,b.selectedPage))},300);de(S,b=>{b.forEach(d=>{de([()=>d.platform,()=>d.selectedPage],async([_,B],[l,e])=>{(_!==l||B!==e)&&(await Ne(),I(d))}),de(()=>d.platform,(_,B)=>{_!==B&&(d.selectedPage="",d.selectedLocation="",d.checkLocation="",d.locationKeys=[])})})},{deep:!0});const F=()=>{let b=!0;S.value.forEach((d,_)=>{H(d,_)||(b=!1)}),U.value.trim()||(x.value=!1),b&&(console.log(S.value),G.value=Fe(S.value),D.value=!0)},K=()=>{S.value=[{action:"",platform:"",selectedPage:"",desc:"",value:"",selectedCase:"",selectedLocation:"",checkLocation:"",saveElementKey:"",selectedJob:"",locationKeys:[]}]},W=async()=>{w.value=await ve("wishpost"),V.value=await ve("wishwms"),h.value=await Ke(),$.value=await Le()},Z=async()=>{q.value=!1,D.value=!1,K(),await W()},J=()=>{U.value.trim()?x.value=!0:x.value=!1};return ke(async()=>{await W()}),(b,d)=>{const _=P("el-button"),B=P("el-input");return k(),L("div",null,[c(xe,{steps:S.value,"onUpdate:steps":d[0]||(d[0]=l=>S.value=l)},null,8,["steps"]),c(_,{onClick:F,class:"submit-btn"},{default:g(()=>d[8]||(d[8]=[A("Preview")])),_:1}),D.value?(k(),L("div",gl,[y("div",yl,[y("div",bl,[d[10]||(d[10]=y("h3",null,"Preview",-1)),c(_,{onClick:d[1]||(d[1]=l=>D.value=!1),class:"close-btn"},{default:g(()=>d[9]||(d[9]=[A("×")])),_:1})]),y("pre",null,pe(G.value),1),c(_,{onClick:d[2]||(d[2]=l=>q.value=!0),class:"submit-btn"},{default:g(()=>d[11]||(d[11]=[A("Submit")])),_:1})])])):E("",!0),q.value?(k(),L("div",wl,[y("div",Cl,[y("div",hl,[d[13]||(d[13]=y("h3",null,"Submit Case",-1)),c(_,{onClick:d[3]||(d[3]=l=>q.value=!1),class:"close-btn"},{default:g(()=>d[12]||(d[12]=[A("×")])),_:1})]),y("div",kl,[d[14]||(d[14]=y("span",null,"Case Name: ",-1)),c(B,{modelValue:U.value,"onUpdate:modelValue":d[4]||(d[4]=l=>U.value=l),class:se(["case-name-input",{"is-invalid":!x.value}]),onBlur:J},null,8,["modelValue","class"]),d[15]||(d[15]=y("span",null,"Priority: ",-1)),c(z,{modelValue:R.value,"onUpdate:modelValue":d[5]||(d[5]=l=>R.value=l),options:[{value:"P0",label:"P0"},{value:"P1",label:"P1"},{value:"P2",label:"P2"},{value:"P3",label:"P3"}],filterable:""},null,8,["modelValue"]),d[16]||(d[16]=y("span",null,"Assignee: ",-1)),c(z,{modelValue:M.value,"onUpdate:modelValue":d[6]||(d[6]=l=>M.value=l),options:[{value:"Jay",label:"Jay"},{value:"Byron",label:"Byron"},{value:"Alex",label:"Alex"}],filterable:""},null,8,["modelValue"])]),c(_,{onClick:d[7]||(d[7]=l=>re(Jt)(U.value,R.value,M.value,G.value,Z)),class:"submit-btn"},{default:g(()=>d[17]||(d[17]=[A("Confirm")])),_:1})])])):E("",!0)])}}},Ue=be(Vl,[["__scopeId","data-v-11156cb6"]]),Sl={class:"config-container"},Al={class:"filter-container"},Tl={key:0,class:"new_config_container"},$l={class:"new-config-header"},El={class:"value-cell-content"},Pl={class:"action-buttons"},_l={class:"new-config-footer"},Ll={__name:"ConfigView",setup(m){const i=C(""),s=C("wishpost"),u=C("wishpost"),t=C(""),r=C([]),o=C(!1),a=C([{key:"",values:[""]}]),w=C("New Config"),V=C(!1),$=C(!1),h=C(!0),S=C(!0);ke(async()=>{r.value=await we(s.value)});const D=$e(()=>r.value.filter(f=>!i.value||f.name.toLowerCase().includes(i.value.toLowerCase()))),q=async()=>{r.value=await we(s.value)},U=(f,p)=>{f.key=p},R=(f,p,I)=>{f.values[I]=p},M=f=>{f.values.push("")},x=f=>{a.value.push({key:"",values:[""]})},G=f=>{a.value.length>1&&a.value.splice(f,1)},ee=(f,p)=>{f.values.length>1&&f.values.splice(p,1)},ae=()=>{o.value=!0,w.value="New Config",V.value=!1,$.value=!1,t.value="",a.value=[{key:"",values:[""]}],u.value=s.value},oe=async f=>{const p=await ta(s.value,f.name);a.value=Object.entries(p).map(([I,F])=>({key:I,values:Array.isArray(F)?F:[F]})),t.value=f.name,u.value=s.value,o.value=!0,w.value="Edit Config",V.value=!0,$.value=!0},ue=async f=>{he.confirm("Confirm to delete this config?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{await sa(s.value,f.name)?(N({title:"Success",message:"Config deleted successfully",type:"success"}),r.value=await we(s.value),i.value=""):N({title:"Error",message:"Config deleted failed",type:"error"})}).catch(()=>{console.log("Overwrite cancelled")})},ne=()=>{for(const f of a.value){if(!f.key.trim())return!1;for(const p of f.values)if(!p.trim())return!1}return!0},ie=async(f,p,I)=>{await la(f,p,I)?(N({title:"Success",message:"Config submitted successfully",type:"success"}),o.value=!1,r.value=await we(s.value),a.value=[{key:"",values:[""]}],t.value=""):N({title:"Error",message:"Save to Consul failed",type:"error"})},me=async()=>{if(!t.value.trim()){h.value=!1;return}if(h.value=!0,!ne()){S.value=!1;return}S.value=!0;const f=Yt(a.value);w.value==="Edit Config"?ie(u.value,t.value,f):(await we(s.value)).some(F=>F.name===t.value)?he.confirm("File Name already exists, do you want to overwrite it?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{ie(u.value,t.value,f)}).catch(()=>{console.log("Overwrite cancelled")}):ie(u.value,t.value,f)},H=()=>{t.value.trim()&&(h.value=!0)};return(f,p)=>{const I=P("el-option"),F=P("el-select"),K=P("el-button"),W=P("el-table-column"),Z=P("el-input"),J=P("el-table"),b=P("el-icon");return k(),L(ge,null,[y("div",Sl,[y("div",Al,[p[6]||(p[6]=y("span",null,"Platform:",-1)),c(F,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=d=>s.value=d),onChange:q,placeholder:"Select Platform",class:"select-platform"},{default:g(()=>[c(I,{label:"WishPost",value:"wishpost"}),c(I,{label:"WishWMS",value:"wishwms"})]),_:1},8,["modelValue"]),c(K,{type:"primary",onClick:ae,class:"new-button"},{default:g(()=>p[5]||(p[5]=[A("New")])),_:1})]),c(J,{data:D.value,class:"config-table"},{default:g(()=>[c(W,{prop:"name",label:"Name"}),c(W,{align:"right"},{header:g(()=>[c(Z,{modelValue:i.value,"onUpdate:modelValue":p[1]||(p[1]=d=>i.value=d),size:"small",placeholder:"Type to search"},null,8,["modelValue"])]),default:g(d=>[c(K,{size:"small",onClick:_=>oe(d.row)},{default:g(()=>p[7]||(p[7]=[A(" Edit ")])),_:2},1032,["onClick"]),c(K,{size:"small",type:"danger",onClick:_=>ue(d.row)},{default:g(()=>p[8]||(p[8]=[A(" Delete ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),o.value?(k(),L("div",Tl,[y("div",$l,[y("h3",null,pe(w.value),1),c(K,{onClick:p[2]||(p[2]=d=>o.value=!1),class:"close-btn"},{default:g(()=>p[9]||(p[9]=[A("×")])),_:1})]),p[13]||(p[13]=y("span",null,"Platform:",-1)),c(F,{modelValue:u.value,"onUpdate:modelValue":p[3]||(p[3]=d=>u.value=d),placeholder:"Select Platform",class:"select-platform",disabled:V.value},{default:g(()=>[c(I,{label:"WishPost",value:"wishpost"}),c(I,{label:"WishWMS",value:"wishwms"})]),_:1},8,["modelValue","disabled"]),p[14]||(p[14]=y("span",{class:"file-name-label"},"File Name:",-1)),c(Z,{modelValue:t.value,"onUpdate:modelValue":p[4]||(p[4]=d=>t.value=d),placeholder:"Input File Name",class:se(["file-name-input",{"is-invalid":!h.value}]),disabled:$.value,onBlur:H},null,8,["modelValue","disabled","class"]),c(J,{data:a.value,style:{width:"100%"}},{default:g(()=>[c(W,{label:"Key",width:"250"},{default:g(d=>[c(Z,{modelValue:d.row.key,"onUpdate:modelValue":_=>d.row.key=_,onInput:_=>U(d.row,_),placeholder:"请输入key",class:se(["key-input",{"is-invalid":!S.value&&!d.row.key.trim()}])},null,8,["modelValue","onUpdate:modelValue","onInput","class"])]),_:1}),c(W,{label:"Value",width:"400"},{default:g(d=>[y("div",El,[(k(!0),L(ge,null,Ee(d.row.values,(_,B)=>(k(),L("div",{key:B,class:"input-row"},[c(Z,{modelValue:d.row.values[B],"onUpdate:modelValue":l=>d.row.values[B]=l,onInput:l=>R(d.row,l,B),placeholder:"example: xpath://label[contains(text(), 'text')]",class:se(["value-input",{"is-invalid":!S.value&&!_.trim()}])},null,8,["modelValue","onUpdate:modelValue","onInput","class"]),B===d.row.values.length-1?(k(),O(b,{key:0,class:"add-value-row",onClick:l=>M(d.row)},{default:g(()=>[c(re(je))]),_:2},1032,["onClick"])):d.row.values.length>1?(k(),O(b,{key:1,class:"remove-value-row",onClick:l=>ee(d.row,B)},{default:g(()=>[c(re(ze))]),_:2},1032,["onClick"])):E("",!0)]))),128))])]),_:1}),c(W,{label:"Action",width:"150"},{default:g(d=>[y("div",Pl,[d.$index===a.value.length-1?(k(),O(K,{key:0,type:"primary",size:"small",onClick:_=>x(d.row)},{default:g(()=>p[10]||(p[10]=[A("Add")])),_:2},1032,["onClick"])):E("",!0),d.row.key.length>1?(k(),O(K,{key:1,type:"danger",size:"small",onClick:_=>G(d.$index)},{default:g(()=>p[11]||(p[11]=[A("Delete")])),_:2},1032,["onClick"])):E("",!0)])]),_:1})]),_:1},8,["data"]),y("div",_l,[c(K,{type:"primary",onClick:me},{default:g(()=>p[12]||(p[12]=[A("Save")])),_:1})])])):E("",!0)],64)}}},Je=be(Ll,[["__scopeId","data-v-eef6b9b8"]]),Ul={class:"dialog-footer"},Il={__name:"CaseList",setup(m){const i=C([]),s=C(""),u=C(!1),t=C(""),r=C(null),o=C([{action:"",platform:"",selectedPage:"",desc:"",value:"",selectedCase:"",selectedLocation:"",checkLocation:"",saveElementKey:"",selectedJob:"",locationKeys:[],customAction:"",needArgs:!1,valueIsEnv:!1,customActionArgs:[],descValid:!0,valueValid:!0,secondsValid:!0,saveValid:!0,customActionValid:!0,caseValid:!0,actionValid:!0,waitSeconds:""}]);ke(async()=>{i.value=await Ce()});const a=$e(()=>i.value.filter(f=>!s.value||f.name.toLowerCase().includes(s.value.toLowerCase()))),w=f=>{r.value=f,t.value=f.content,o.value=Gt(f.content),console.log(o.value),u.value=!0},V=["Click","Assert","Type","Wait","Open","Clear","SaveElementText","UploadImage","TriggerCronJob","SaveTimestampAsEnv","CustomAction"],$=["Page","Click","Assert","Type","ClickUntilExist","Clear","SaveElementText","UploadImage"],h=["ClickUntilExist"],S=["Type"],D=["Wait"],q=["SaveElementText","SaveTimestampAsEnv"],U=["CustomAction"],R=f=>V.includes(f),M=f=>S.includes(f),x=f=>$.includes(f),G=f=>h.includes(f),ee=f=>D.includes(f),ae=f=>q.includes(f),oe=f=>U.includes(f),ue=(f,p)=>f.action.trim()?R(f.action)&&!f.desc.trim()?(o.value[p].descValid=!1,!1):M(f.action)&&!f.value.trim()?(o.value[p].valueValid=!1,!1):ee(f.action)&&!f.waitSeconds.trim()?(o.value[p].secondsValid=!1,!1):ae(f.action)&&!f.saveElementKey.trim()?(o.value[p].saveValid=!1,!1):oe(f.action)&&!f.customAction.trim()?(o.value[p].customActionValid=!1,!1):!(f.action==="Case"&&!f.selectedCase.trim()||x(f.action)&&(!f.platform.trim()||!f.selectedPage.trim())||x(f.action)&&f.action!="Page"&&f.selectedLocation===""||G(f.action)&&f.checkLocation===""||f.action==="TriggerCronJob"&&f.selectedJob===""):(o.value[p].actionValid=!1,!1),ne=async()=>{let f=!0;if(o.value.forEach((K,W)=>{ue(K,W)||(f=!1)}),!f)return;const p=Fe(o.value),I=r.value.id,F=r.value.name;await Wt(I,F,p,ie),i.value=await Ce(),u.value=!1},ie=async()=>{u.value=!1,await Ce()},me=async()=>{i.value=await Ce()},H=async f=>{he.confirm("Confirm to delete this case?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{r.value=f,await zt(r.value.id,me)}).catch(()=>{console.log("user cancel delete.")})};return(f,p)=>{const I=P("el-table-column"),F=P("el-input"),K=P("el-button"),W=P("el-table"),Z=P("el-dialog");return k(),L(ge,null,[c(W,{data:a.value,class:"config-table"},{default:g(()=>[c(I,{prop:"name",label:"Name"}),c(I,{align:"right"},{header:g(()=>[c(F,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=J=>s.value=J),size:"small",placeholder:"Type to search"},null,8,["modelValue"])]),default:g(J=>[c(K,{size:"small",onClick:b=>w(J.row)},{default:g(()=>p[4]||(p[4]=[A(" Edit ")])),_:2},1032,["onClick"]),c(K,{size:"small",type:"danger",onClick:b=>H(J.row)},{default:g(()=>p[5]||(p[5]=[A(" Delete ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c(Z,{modelValue:u.value,"onUpdate:modelValue":p[3]||(p[3]=J=>u.value=J),title:"Case Edit",width:"80%"},{footer:g(()=>[y("span",Ul,[c(K,{onClick:p[2]||(p[2]=J=>u.value=!1)},{default:g(()=>p[6]||(p[6]=[A("Cancel")])),_:1}),c(K,{type:"primary",onClick:ne},{default:g(()=>p[7]||(p[7]=[A("Save")])),_:1})])]),default:g(()=>[c(xe,{steps:o.value,"onUpdate:steps":p[1]||(p[1]=J=>o.value=J)},null,8,["steps"])]),_:1},8,["modelValue"])],64)}}},Be=be(Il,[["__scopeId","data-v-1907ed61"]]),Ol={class:"suite-container"},jl={class:"button-container"},Nl={key:0,class:"new_suite_container"},Kl={class:"new-config-dialog"},Dl={class:"new-config-header"},Fl={class:"submit-body"},xl={class:"new-config-footer"},Jl={class:"el-table el-table--fit link-case-draggable-table"},Bl={class:"draggable-row"},Rl={style:{"text-align":"right"}},Wl={class:"add-case-btn-container"},zl={style:{"margin-top":"20px","text-align":"right"}},ql={__name:"SuiteList",setup(m){const i=C([]),s=C(""),u=C(null),t=C(1),r=C(20),o=C(0),a=C(!1),w=C("New Suite"),V=C(""),$=C(""),h=C(""),S=C(""),D=C(!0),q=C(!1),U=C([]),R=C(""),M=C([]),x=C(!1),G=()=>{a.value=!0,w.value="New Suite",V.value="",$.value="",h.value=""},ee=async l=>{he.confirm("Confirm to unlink this case?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{await Ht(l.id,ae)}).catch(()=>{console.log("user cancel delete.")})},ae=async()=>{const l=await _e(S.value);U.value=Array.isArray(l)?l:[],R.value=""},oe=async l=>{S.value=l.id,q.value=!0;const e=await _e(l.id);U.value=Array.isArray(e)?e:[],M.value=await Ce()},ue=()=>{h.value.trim()?D.value=!0:D.value=!1},ne=()=>{V.value="",$.value="",h.value=""},ie=async()=>{a.value=!1,ne(),await f(),await H()},me=async()=>{a.value=!1,ne(),await f(),await H()},H=async()=>{i.value=await xt(t.value,r.value)},f=async()=>{o.value=await Dt()};ke(async()=>{await f(),await H()});const p=async l=>{he.confirm("Confirm to delete this suite?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{u.value=l,await qt(u.value.id,I)}).catch(()=>{console.log("user cancel delete.")})},I=async()=>{await f(),await H()},F=async l=>{a.value=!0,w.value="Edit Suite",h.value=l.name,V.value=l.assignee,$.value=b(l)[0],S.value=l.id},K=async l=>{t.value=l,await H()},W=async l=>{r.value=l,t.value=1,await H()},Z=async()=>{t.value=1,await H()},J=$e(()=>i.value.filter(l=>!s.value||l.name.toLowerCase().includes(s.value.toLowerCase())));function b(l){if(Array.isArray(l.tags))return l.tags;if(typeof l.tags=="string")try{const e=JSON.parse(l.tags);return Array.isArray(e)?e:e?[e]:[]}catch{return l.tags?[l.tags]:[]}return[]}const d=async()=>{w.value==="New Suite"?await Bt(h.value,V.value,$.value,ie):await Rt(S.value,h.value,V.value,$.value,me)},_=async()=>{const l=R.value,e=M.value.find(j=>j.id===l),T=e?e.name:"";await Mt(l,T,S.value,async()=>{const j=await _e(S.value);U.value=Array.isArray(j)?j:[],x.value=!1,R.value=""})},B=l=>{var te,ce;if(l.oldIndex===l.newIndex)return;const e=U.value[l.newIndex];U.value[l.oldIndex];let T="AFTER",j=null;l.newIndex>l.oldIndex?(T="AFTER",j=(te=U.value[l.newIndex-1])==null?void 0:te.id):(T="BEFORE",j=(ce=U.value[l.newIndex+1])==null?void 0:ce.id),j&&Xt(S.value,e.id,j,T)};return(l,e)=>{const T=P("el-button"),j=P("el-input"),te=P("el-table-column"),ce=P("el-table"),Pe=P("el-pagination"),fe=P("el-dialog");return k(),L("div",Ol,[y("div",jl,[c(T,{type:"primary",onClick:G},{default:g(()=>e[14]||(e[14]=[A("New")])),_:1})]),a.value?(k(),L("div",Nl,[y("div",Kl,[y("div",Dl,[y("h3",null,pe(w.value),1),c(T,{onClick:e[0]||(e[0]=n=>a.value=!1),class:"close-btn",circle:""},{default:g(()=>e[15]||(e[15]=[A("×")])),_:1})]),y("div",Fl,[e[16]||(e[16]=y("span",null,[A("Suite Name: "),y("span",{class:"required"},"*")],-1)),c(j,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=n=>h.value=n),class:se(["suite-name-input",{"is-invalid":!D.value}]),onBlur:ue,placeholder:"请输入 Suite 名称"},null,8,["modelValue","class"]),e[17]||(e[17]=y("span",null,[A("Tag: "),y("span",{class:"required"},"*")],-1)),c(z,{modelValue:$.value,"onUpdate:modelValue":e[2]||(e[2]=n=>$.value=n),options:[{value:"Wishpost",label:"Wishpost"},{value:"Wishwms",label:"Wishwms"},{value:"Uni",label:"Uni"},{value:"testingEnv",label:"testingEnv"}]},null,8,["modelValue"]),e[18]||(e[18]=y("span",null,[A("Assignee: "),y("span",{class:"required"},"*")],-1)),c(z,{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=n=>V.value=n),options:[{value:"Jay",label:"Jay"},{value:"Byron",label:"Byron"},{value:"Alex",label:"Alex"}]},null,8,["modelValue"])]),y("div",xl,[c(T,{onClick:e[4]||(e[4]=n=>a.value=!1)},{default:g(()=>e[19]||(e[19]=[A("Cancel")])),_:1}),c(T,{type:"primary",onClick:d},{default:g(()=>e[20]||(e[20]=[A("Save")])),_:1})])])])):E("",!0),c(ce,{data:J.value,class:"config-table"},{default:g(()=>[c(te,{prop:"name",label:"Name"}),c(te,{prop:"tags",label:"Tags"},{default:g(n=>[(k(!0),L(ge,null,Ee(b(n.row),(X,v)=>(k(),L("span",{key:v,class:"tag-span"},pe(X),1))),128))]),_:1}),c(te,{align:"right"},{header:g(()=>[c(j,{modelValue:s.value,"onUpdate:modelValue":e[5]||(e[5]=n=>s.value=n),size:"small",placeholder:"Type to search",onInput:Z},null,8,["modelValue"])]),default:g(n=>[c(T,{size:"small",onClick:X=>oe(n.row)},{default:g(()=>e[21]||(e[21]=[A("Link Case")])),_:2},1032,["onClick"]),c(T,{size:"small",onClick:X=>F(n.row)},{default:g(()=>e[22]||(e[22]=[A(" Edit ")])),_:2},1032,["onClick"]),c(T,{size:"small",type:"danger",onClick:X=>p(n.row)},{default:g(()=>e[23]||(e[23]=[A(" Delete ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c(Pe,{"current-page":t.value,"onUpdate:currentPage":e[6]||(e[6]=n=>t.value=n),"page-size":r.value,"onUpdate:pageSize":e[7]||(e[7]=n=>r.value=n),"page-sizes":[10,20,50,100],total:o.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:K,onSizeChange:W,style:{"margin-top":"20px"}},null,8,["current-page","page-size","total"]),c(fe,{modelValue:q.value,"onUpdate:modelValue":e[10]||(e[10]=n=>q.value=n),title:"Linked Cases",width:"70%"},{default:g(()=>[y("table",Jl,[e[25]||(e[25]=y("thead",null,[y("tr",null,[y("th",{class:"left-align"},"Name"),y("th",{style:{"text-align":"right"}})])],-1)),c(re(qe),{modelValue:U.value,"onUpdate:modelValue":e[8]||(e[8]=n=>U.value=n),"item-key":"id",tag:"tbody",animation:200,"force-fallback":!0,onEnd:B},{item:g(({element:n,index:X})=>[y("tr",Bl,[y("td",null,pe(n.name),1),y("td",Rl,[c(T,{size:"small",type:"danger",onClick:v=>ee(n),class:"remove-btn"},{default:g(()=>e[24]||(e[24]=[A(" Remove ")])),_:2},1032,["onClick"])])])]),_:1},8,["modelValue"])]),y("div",Wl,[c(T,{type:"primary",onClick:e[9]||(e[9]=n=>x.value=!0)},{default:g(()=>e[26]||(e[26]=[A("Add Case")])),_:1})])]),_:1},8,["modelValue"]),c(fe,{modelValue:x.value,"onUpdate:modelValue":e[13]||(e[13]=n=>x.value=n),class:"add-case-dialog",title:"Add Case"},{default:g(()=>[e[29]||(e[29]=y("span",null,"Case: ",-1)),c(z,{modelValue:R.value,"onUpdate:modelValue":e[11]||(e[11]=n=>R.value=n),options:M.value.map(n=>({label:n.name,value:n.id})),filterable:""},null,8,["modelValue","options"]),y("div",zl,[c(T,{onClick:e[12]||(e[12]=n=>x.value=!1)},{default:g(()=>e[27]||(e[27]=[A("Cancel")])),_:1}),c(T,{type:"primary",onClick:_},{default:g(()=>e[28]||(e[28]=[A("Save")])),_:1})])]),_:1},8,["modelValue"])])}}},Re=be(ql,[["__scopeId","data-v-20ef943a"]]),Ml=Me({history:He("/"),routes:[{path:"/",name:"home",component:Ue},{path:"/case",name:"case",component:Ue},{path:"/config",name:"config",component:Je},{path:"/case-list",name:"case-list",component:Be},{path:"/suite-list",name:"suite-list",component:Re}]}),Hl={__name:"App",setup(m){const i=Xe(),s=Ye(),u=C("Case");de(()=>s.name,r=>{r==="case"||r==="home"?u.value="Case":r==="config"?u.value="Config":r==="case-list"?u.value="CaseList":r==="suite-list"?u.value="SuiteList":u.value="Case"},{immediate:!0});const t=r=>{r.props.label==="Case"?i.push("/case"):r.props.label==="Config"?i.push("/config"):r.props.label==="CaseList"?i.push("/case-list"):r.props.label==="SuiteList"&&i.push("/suite-list")};return(r,o)=>{const a=P("el-tab-pane"),w=P("el-tabs");return k(),O(w,{"tab-position":"top",class:"menu-tabs",onTabClick:t,modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=V=>u.value=V)},{default:g(()=>[c(a,{label:"Case",name:"Case"},{default:g(()=>[(k(),O(Te,null,[u.value==="Case"?(k(),O(Ue,{key:0})):E("",!0)],1024))]),_:1}),c(a,{label:"Config",name:"Config"},{default:g(()=>[(k(),O(Te,null,[u.value==="Config"?(k(),O(Je,{key:0})):E("",!0)],1024))]),_:1}),c(a,{label:"CaseList",name:"CaseList"},{default:g(()=>[(k(),O(Te,null,[u.value==="CaseList"?(k(),O(Be,{key:0})):E("",!0)],1024))]),_:1}),c(a,{label:"SuiteList",name:"SuiteList"},{default:g(()=>[(k(),O(Te,null,[u.value==="SuiteList"?(k(),O(Re,{key:0})):E("",!0)],1024))]),_:1})]),_:1},8,["modelValue"])}}},Ve=Ge(Hl);for(const[m,i]of Object.entries(Qe))Ve.component(m,i);Ve.use(Ze());Ve.use(ea);Ve.use(Ml);Ve.mount("#app");
